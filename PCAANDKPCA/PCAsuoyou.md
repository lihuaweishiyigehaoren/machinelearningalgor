### PCA、MPCA、KPCA（一）

#### 前言

当你选择看这篇文章时，相信你对降维方法有了一定的了解。而这篇博客，是帮你进阶为一个PCA降维技术专家，深入理解其原理、公式推导的过程。

#### 现状

PCA可以从周志华的西瓜书或者李航的统计学习方法中找到。在此文中，我会以更易理解的方法简要的介绍一下PCA的原理和公式推导，具体的思路其实与上两文差异不大，而对于MPCA和KPCA，国内的资料几乎没有，对于一些人写的博客我都选择性忽略，而国外动辄上百页的英文文档着实很不友好。

也许有些人会说，MPCA不就是引入“张量”，KPCA不就是将数据先投射到更高维空间使其线性可分，但是你们其中有几个人能对其中的具体推导有一个大致的概念。

#### 正文



## MPCA

在介绍MPCA之前，先介绍一个概念-张量

#### 张量

我们的目的是用数学量来表示物理量，可是标量加上向量，都不足以表达所有的物理量，故需要引入张量的概念，来扩大数学量的概念。

###### 张量的概念

几何代数中定义的张量是基于向量和矩阵的推广，通俗理解的话，我们可以将标量视为零阶张量，矢量视为一阶张量，而矩阵视为二阶张量。

##### 张量的定义

张量的严格定义是利用线性映射来描述的。与矢量相类似，定义由若干坐标系改变时满足一定坐标转化关系的有序数组组成的集合为张量。从几何的角度讲，它是一个真正的几何量，也就是说，它是一个不随参考系的坐标变化（其实就是基向量变化）而变化的东西。最后的结果就是基向量与对应基向量上的分量的组合（也就是张量）保持不变，比如一阶张量（向量）a可表示为a = x***i**+y***j**。由于基向量可以有丰富的组合，张量可以表示非常非常丰富的物理量。

是不是看了这么多，张量对你来说还是很抽象？不怕，这个视频介绍给你（链接：https://www.youtube.com/watch?v=f5liqUk0ZTw&t=66s），如果你还是不懂，我劝你还是放弃治疗吧（哈哈，开玩笑撒，需要翻墙哈）

MPCA计算过程：

输入：一批张量样本
$$
\left \{  {\chi _{m}\epsilon \mathbb{R}^{I_{1}\times I_{2}\times  \cdots \times I_{N}},m=1,\cdots ,M}\right \};其中\chi为输入张量，I是每个张量的某个维度
$$
输出：相同数量的一批张量样本(每个张量在其各个维度上进行了最大程度的降维)
$$
\left \{ \upsilon { _{m}\epsilon \mathbb{R}^{P_{1}\times P_{2}\times  \cdots \times P_{N}},m=1,\cdots ,M}\right \}；其中\upsilon是输出张量
$$
算法步骤：

1、(预处理) 样本中心化
$$
\left \{ \bar{\chi _{m}}= \chi _{m}-\bar{\chi }，m=1,2……，M \right \}，其中\bar{\chi }= \frac{1}{M}\sum _{m=1}^{M}\chi _{m}为样本中心
$$
2、(初始化) 计算下式的特征分解
$$
\Phi ^{(n)*}=\sum _{m=1}^{M}\bar{X}_{m(n)} \cdot \bar{X}_{m(n)}^{T}其中\Phi ^{(n)}是一个n维（n个向量)组成的矩阵
$$
​    并且设置：
$$
\bar{U}^{(n)}由所有有效特征值P_{n}(n=1、2、……，N)对应的特征向量组成
$$
3、(局部优化)

- 计算：
  $$
  \left \{ \bar{\nu }_{m}= \bar{\chi }_{m}\times _{1}\bar{U}^{(1)^{T} }\times _{2}\bar{U^{(2)^{T}}}\cdots\times _{N}\bar{U}^{(N)^{T}},m=1、2……、M \right \}
  $$

- 计算：
  $$
  \psi _{\nu _{0}}= \sum _{m=1}^{M}\begin{Vmatrix}
  \bar{\nu }_{m}
  \end{Vmatrix}_{F}^{2}(其中\bar{\bar{\nu }}全为0，因为\bar{\chi }_{m}是中心化的)；其中\psi _{\nu _{0}}是总体的张量散度
  $$
  

- For k=1:K

  ​    For n = 1:N
  $$
  设置\bar{U}^{(n)}由所有有效特征值P_{n}(n=1、2、……，N)对应的特征向量组成
  $$
  ​    计算：
  $$
  \left \{ \bar{\nu }_{m}，m=1,2……，M\right \}和\psi _{\nu _{k}}
  $$
  

​           如果：
$$
\psi _{\nu _{k}}-\psi _{\nu _{k=1}}<\eta ，停止并进入步骤4
$$
4、（推测）：演算之后获得的特征张量是：
$$
\left \{ \nu _{m}= \chi _{m}\times _{1}\bar{U}^{(1)^{T} }\times _{2}\bar{U^{(2)^{T}}}\cdots\times _{N}\bar{U}^{(N)^{T}},m=1、2……、M \right \}
$$
至此，MPCA的计算过程结束；

